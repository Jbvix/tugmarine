<!DOCTYPE html>
<html lang="pt-pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TUGLIFE Marine - Command Center v4.2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #020617;
            color: #f8fafc;
            -webkit-tap-highlight-color: transparent;
        }

        .glass-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-card:active {
            transform: scale(0.97);
            background: rgba(30, 41, 59, 0.8);
        }

        .glow-blue {
            box-shadow: 0 0 30px -10px rgba(59, 130, 246, 0.3);
        }

        .glow-emerald {
            box-shadow: 0 0 30px -10px rgba(16, 185, 129, 0.3);
        }

        .glow-amber {
            box-shadow: 0 0 30px -10px rgba(245, 158, 11, 0.2);
        }

        .logo-gradient {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            box-shadow: 0 0 25px rgba(37, 99, 235, 0.4);
        }

        input::placeholder {
            color: #475569;
            font-weight: 600;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(2, 6, 23, 0.9);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .scroll-hide::-webkit-scrollbar {
            display: none;
        }

        .scroll-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col p-6 pb-12">

    <!-- Header Central de Comando -->
    <header class="max-w-md mx-auto w-full text-center pt-8">
        <div
            class="inline-flex items-center justify-center w-20 h-20 logo-gradient rounded-[2rem] mb-6 border-2 border-white/10 animate-pulse">
            <span class="text-3xl font-black italic text-white tracking-tighter">TL</span>
        </div>
        <h1 class="text-4xl font-black uppercase italic tracking-tighter text-white leading-none">
            Tuglife <span class="text-blue-500">Marine</span>
        </h1>
        <p class="text-[10px] uppercase font-bold tracking-[0.4em] text-slate-500 mt-3 italic">Marine Engineering Suite
            v4.2</p>
    </header>

    <!-- Identidade da Operação -->
    <section class="max-w-md mx-auto w-full mt-10 space-y-4">
        <div class="glass-card rounded-[2.5rem] p-6 space-y-4 shadow-2xl border-t border-white/5">
            <div class="flex items-center space-x-2 px-2 mb-2">
                <i data-lucide="anchor" class="w-3 h-3 text-blue-500"></i>
                <h3 class="text-[9px] font-black text-slate-400 uppercase tracking-[0.2em]">Identidade da Operação</h3>
            </div>

            <div class="space-y-3">
                <div class="relative">
                    <input type="text" id="global-vessel" oninput="saveIdentity()" placeholder="REBOCADOR"
                        class="w-full bg-slate-900/50 border border-slate-700/50 rounded-2xl p-4 pl-12 text-xs font-black uppercase text-white outline-none focus:ring-2 focus:ring-blue-600 transition-all">
                    <i data-lucide="ship" class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-600"></i>
                </div>

                <div class="relative">
                    <input type="text" id="global-port" oninput="saveIdentity()" placeholder="PORTO / FILIAL"
                        class="w-full bg-slate-900/50 border border-slate-700/50 rounded-2xl p-4 pl-12 text-xs font-black uppercase text-white outline-none focus:ring-2 focus:ring-blue-600 transition-all">
                    <i data-lucide="map-pin"
                        class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-600"></i>
                </div>

                <div class="relative">
                    <input type="text" id="global-chemaq" oninput="saveIdentity()" placeholder="NOME DO CHEMAQ"
                        class="w-full bg-slate-900/50 border border-slate-700/50 rounded-2xl p-4 pl-12 text-xs font-black uppercase text-blue-400 outline-none focus:ring-2 focus:ring-blue-600 transition-all">
                    <i data-lucide="user-cog"
                        class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-600"></i>
                </div>
            </div>
        </div>
    </section>

    <!-- Módulos Principais -->
    <main class="max-w-md mx-auto w-full mt-8 space-y-3 flex-1">

        <h3 class="text-[9px] font-black text-slate-600 uppercase tracking-widest pl-4 mb-2">Operações & Engenharia</h3>

        <!-- Calculadora -->
        <a href="TUGLIFE - Marine Calculator.html"
            class="block glass-card rounded-[2rem] p-5 flex items-center space-x-5 glow-blue border-l-4 border-blue-600">
            <div
                class="w-14 h-14 bg-blue-600/10 rounded-2xl flex items-center justify-center text-blue-500 border border-blue-500/20">
                <i data-lucide="calculator" class="w-7 h-7 text-blue-500"></i>
            </div>
            <div class="flex-1">
                <h2 class="text-sm font-black uppercase text-white leading-none">Calculadora</h2>
                <p class="text-[9px] text-slate-400 font-bold uppercase mt-1.5 tracking-tight">Sondagem e Saldo ROB</p>
            </div>
            <i data-lucide="chevron-right" class="text-slate-800 w-5 h-5"></i>
        </a>

        <!-- Bunkering -->
        <a href="TUGLIFE - Advanced Bunkering Assistant v3.5.html"
            class="block glass-card rounded-[2rem] p-5 flex items-center space-x-5 glow-emerald border-l-4 border-emerald-600">
            <div
                class="w-14 h-14 bg-emerald-600/10 rounded-2xl flex items-center justify-center text-emerald-500 border border-emerald-500/20">
                <i data-lucide="fuel" class="w-7 h-7 text-emerald-500"></i>
            </div>
            <div class="flex-1">
                <h2 class="text-sm font-black uppercase text-white leading-none">Bunkering</h2>
                <p class="text-[9px] text-slate-400 font-bold uppercase mt-1.5 tracking-tight">Logística de Carga 5K</p>
            </div>
            <i data-lucide="chevron-right" class="text-slate-800 w-5 h-5"></i>
        </a>

        <!-- Checklist -->
        <a href="Bunkering Checklist.html"
            class="block glass-card rounded-[2rem] p-5 flex items-center space-x-5 shadow-lg border-l-4 border-slate-500">
            <div
                class="w-14 h-14 bg-slate-800 rounded-2xl flex items-center justify-center text-slate-400 border border-slate-700">
                <i data-lucide="clipboard-check" class="w-7 h-7"></i>
            </div>
            <div class="flex-1">
                <h2 class="text-sm font-black uppercase text-white leading-none">Checklist</h2>
                <p class="text-[9px] text-slate-400 font-bold uppercase mt-1.5 tracking-tight">Compliance FOR-OPE-009
                </p>
            </div>
            <i data-lucide="chevron-right" class="text-slate-800 w-5 h-5"></i>
        </a>

        <!-- Grelha de Suporte -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 pt-4">
            <a href="TUGLIFE - Auto Validation Log v2.2.html"
                class="glass-card rounded-3xl p-4 flex flex-col items-center text-center space-y-2 glow-amber border border-amber-500/10">
                <i data-lucide="shield-check" class="text-amber-500 w-6 h-6"></i>
                <span class="text-[9px] font-black uppercase text-slate-300">Auto Auditor</span>
            </a>
            <a href="Histórico TUGLIFE Marine.html"
                class="glass-card rounded-3xl p-4 flex flex-col items-center text-center space-y-2">
                <i data-lucide="history" class="text-blue-400 w-6 h-6"></i>
                <span class="text-[9px] font-black uppercase text-slate-300">Histórico</span>
            </a>
            <a href="TUGLIFE - User Manual.html"
                class="glass-card rounded-3xl p-4 flex flex-col items-center text-center space-y-2 md:col-span-2 border border-slate-700/50">
                <i data-lucide="book-open" class="text-slate-400 w-6 h-6"></i>
                <span class="text-[9px] font-black uppercase text-slate-300">Manual do Usuário</span>
            </a>
        </div>

    </main>

    <!-- Footer -->
    <footer class="mt-auto text-center pt-10 border-t border-slate-900 relative">
        <p class="text-[9px] font-black text-slate-600 uppercase tracking-[0.5em]">Jossian Brito | 2026</p>
        <p class="text-[8px] text-slate-700 font-bold uppercase mt-2">Marine Operations Hub</p>

        <!-- Admin Trigger -->
        <button onclick="openAdminLogin()"
            class="absolute right-0 bottom-0 p-4 opacity-50 hover:opacity-100 transition-opacity">
            <i data-lucide="lock" class="w-3 h-3 text-slate-800"></i>
        </button>
    </footer>

    <!-- Auth Modal -->
    <div id="authModal" class="modal-overlay">
        <div class="glass-card rounded-[2rem] p-8 w-full max-w-sm mx-4 space-y-6 border border-blue-500/20 shadow-2xl transform transition-all scale-95 opacity-0"
            id="modalContent">

            <!-- Login State -->
            <div id="loginState" class="space-y-6">
                <div class="text-center">
                    <div
                        class="w-16 h-16 bg-blue-600/10 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-blue-500/20">
                        <i data-lucide="shield-check" class="w-8 h-8 text-blue-500"></i>
                    </div>
                    <h2 class="text-2xl font-black uppercase italic text-white tracking-tighter">Acesso Restrito</h2>
                    <p class="text-xs text-slate-400 mt-2 font-medium">Identifique-se para continuar</p>
                </div>

                <div class="space-y-3">
                    <input type="password" id="access-token" placeholder="TOKEN DE ACESSO"
                        class="w-full bg-slate-900/80 border border-slate-700 rounded-xl p-4 text-center text-white font-mono tracking-widest outline-none focus:border-blue-500 transition-colors uppercase">

                    <button onclick="verifyAccess()"
                        class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 rounded-xl uppercase tracking-wider text-sm transition-all active:scale-95 shadow-lg shadow-blue-600/20">
                        Entrar
                    </button>
                </div>

                <p onclick="openAdminLogin()"
                    class="text-center text-[10px] uppercase tracking-widest text-slate-600 cursor-pointer hover:text-blue-500 transition-colors">
                    Administração
                </p>
            </div>

            <!-- Admin Login State -->
            <div id="adminLoginState" class="hidden space-y-6">
                <div class="text-center">
                    <div
                        class="w-16 h-16 bg-red-600/10 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-red-500/20">
                        <i data-lucide="lock-keyhole" class="w-8 h-8 text-red-500"></i>
                    </div>
                    <h2 class="text-2xl font-black uppercase italic text-white tracking-tighter">Admin</h2>
                    <p class="text-xs text-slate-400 mt-2 font-medium">Senha Mestra</p>
                </div>

                <div class="space-y-3">
                    <input type="password" id="admin-pass" placeholder="SENHA MESTRA"
                        class="w-full bg-slate-900/80 border border-slate-700 rounded-xl p-4 text-center text-white font-mono tracking-widest outline-none focus:border-red-500 transition-colors">

                    <button onclick="verifyAdmin()"
                        class="w-full bg-red-600 hover:bg-red-500 text-white font-bold py-4 rounded-xl uppercase tracking-wider text-sm transition-all active:scale-95 shadow-lg shadow-red-600/20">
                        Acessar Painel
                    </button>
                </div>

                <p onclick="showLoginState()"
                    class="text-center text-[10px] uppercase tracking-widest text-slate-600 cursor-pointer hover:text-white transition-colors">
                    Voltar
                </p>
            </div>

            <!-- Dashboard State -->
            <div id="adminDashboard" class="hidden space-y-6">
                <div class="flex items-center justify-between pb-4 border-b border-slate-700/50">
                    <h2 class="text-lg font-black uppercase italic text-white">Painel de Controle</h2>
                    <button onclick="logoutAdmin()"
                        class="text-xs text-red-400 font-bold uppercase hover:text-red-300">Sair</button>
                </div>

                <!-- Generate Invite -->
                <div class="space-y-3">
                    <label class="text-[10px] uppercase font-bold text-slate-500">Novo Convite</label>
                    <div class="flex gap-2">
                        <input type="text" id="new-user-name" placeholder="NOME DO USUÁRIO"
                            class="flex-1 bg-slate-900/50 border border-slate-700 rounded-lg p-3 text-xs text-white outline-none focus:border-blue-500">
                        <button onclick="generateToken()"
                            class="bg-blue-600 p-3 rounded-lg text-white hover:bg-blue-500 transition-colors">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>

                <!-- Active Tokens List -->
                <div class="space-y-2">
                    <label class="text-[10px] uppercase font-bold text-slate-500">Acessos Ativos</label>
                    <div id="tokensList" class="space-y-2 max-h-48 overflow-y-auto scroll-hide pr-1">
                        <!-- Tokens injected here -->
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        /**
         * LÓGICA DE SINCRONIZAÇÃO GLOBAL
         * Autor: Jossian Brito | v4.2
         */
        const MASTER_PASS = "tuglife2026"; // Senha inicial
        const APP_URL = window.location.href.split('?')[0]; // URL base para convite

        // Estado
        let currentUser = null;

        // --- AUTH & ADMIN SYSTEM ---

        function initAuth() {
            const savedUser = JSON.parse(localStorage.getItem('TUGLIFE_SESSION'));
            if (!savedUser) {
                showModal(true);
            } else {
                currentUser = savedUser;
                // Opcional: Validar se o token ainda existe na lista de permitidos
                const allTokens = JSON.parse(localStorage.getItem('TUGLIFE_TOKENS') || '[]');
                const isValid = allTokens.find(t => t.token === currentUser.token);
                if (!isValid) {
                    logout();
                }
            }
        }

        function showModal(show) {
            const modal = document.getElementById('authModal');
            const content = document.getElementById('modalContent');

            if (show) {
                modal.classList.add('active');
                setTimeout(() => {
                    content.classList.remove('scale-95', 'opacity-0');
                    content.classList.add('scale-100', 'opacity-100');
                }, 10);
            } else {
                content.classList.remove('scale-100', 'opacity-100');
                content.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.remove('active');
                }, 300);
            }
        }

        function showLoginState() {
            document.getElementById('loginState').classList.remove('hidden');
            document.getElementById('adminLoginState').classList.add('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
        }

        function openAdminLogin() {
            document.getElementById('loginState').classList.add('hidden');
            document.getElementById('adminLoginState').classList.remove('hidden');
        }

        function verifyAccess() {
            const inputToken = document.getElementById('access-token').value.trim().toUpperCase();
            const allTokens = JSON.parse(localStorage.getItem('TUGLIFE_TOKENS') || '[]');

            const found = allTokens.find(t => t.token === inputToken);

            if (found) {
                // Sucesso
                const session = { name: found.name, token: found.token, loginDate: new Date().toISOString() };
                localStorage.setItem('TUGLIFE_SESSION', JSON.stringify(session));
                currentUser = session;
                showModal(false);
            } else {
                alert('Token inválido ou revogado.');
            }
        }

        function verifyAdmin() {
            const pass = document.getElementById('admin-pass').value;
            if (pass === MASTER_PASS) {
                document.getElementById('adminLoginState').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
                renderTokensList();
            } else {
                alert('Senha incorreta.');
            }
        }

        function logoutAdmin() {
            showLoginState();
        }

        function logout() {
            localStorage.removeItem('TUGLIFE_SESSION');
            currentUser = null;
            location.reload();
        }

        // --- TOKEN MANAGEMENT ---

        function generateToken() {
            const name = document.getElementById('new-user-name').value.trim();
            if (!name) return alert('Digite o nome do usuário.');

            const token = Math.random().toString(36).substring(2, 8).toUpperCase();

            const newToken = {
                name: name,
                token: token,
                createdAt: new Date().toISOString()
            };

            const tokens = JSON.parse(localStorage.getItem('TUGLIFE_TOKENS') || '[]');
            tokens.push(newToken);
            localStorage.setItem('TUGLIFE_TOKENS', JSON.stringify(tokens));

            document.getElementById('new-user-name').value = '';
            renderTokensList();
        }

        function revokeToken(tokenToRevoke) {
            if (!confirm('Revogar este acesso?')) return;

            let tokens = JSON.parse(localStorage.getItem('TUGLIFE_TOKENS') || '[]');
            tokens = tokens.filter(t => t.token !== tokenToRevoke);
            localStorage.setItem('TUGLIFE_TOKENS', JSON.stringify(tokens));
            renderTokensList();
        }

        function copyInvite(token, name) {
            const message = `Olá *${name}*, aqui está seu acesso ao *TUGLIFE Marine Command Center*.\n\nLink: ${APP_URL}\nToken DE ACESSO: *${token}*\n\nInsira este token para entrar.`;
            navigator.clipboard.writeText(message).then(() => {
                alert('Convite copiado para a área de transferência!');
            }).catch(err => {
                console.error('Erro ao copiar:', err);
            });
        }

        function sendWhatsApp(token, name) {
            const message = `Olá *${name}*, aqui está seu acesso ao *TUGLIFE Marine Command Center*.\n\nLink: ${APP_URL}\nToken DE ACESSO: *${token}*\n\nInsira este token para entrar.`;
            const url = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }

        function renderTokensList() {
            const list = document.getElementById('tokensList');
            const tokens = JSON.parse(localStorage.getItem('TUGLIFE_TOKENS') || '[]');

            if (tokens.length === 0) {
                list.innerHTML = '<p class="text-[10px] text-slate-500 italic text-center py-4">Nenhum acesso ativo.</p>';
                return;
            }

            list.innerHTML = tokens.map(t => `
                <div class="bg-slate-800/50 rounded-lg p-3 flex items-center justify-between border border-white/5">
                    <div>
                        <p class="text-xs font-bold text-white">${t.name}</p>
                        <p class="text-[10px] text-blue-400 font-mono tracking-wider">${t.token}</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="copyInvite('${t.token}', '${t.name}')" class="text-slate-400 hover:text-white p-1" title="Copiar Link">
                            <i data-lucide="link" class="w-4 h-4"></i>
                        </button>
                        <button onclick="sendWhatsApp('${t.token}', '${t.name}')" class="text-green-500 hover:text-green-400 p-1" title="Enviar whatsapp">
                            <i data-lucide="message-circle" class="w-4 h-4"></i>
                        </button>
                        <button onclick="revokeToken('${t.token}')" class="text-red-500 hover:text-red-400 p-1" title="Revogar">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `).join('');

            lucide.createIcons();
        }

        function saveIdentity() {
            const data = {
                vessel: document.getElementById('global-vessel').value,
                port: document.getElementById('global-port').value
            };
            const chemaq = document.getElementById('global-chemaq').value;

            // Persistência em LocalStorage (Barramento de Dados)
            localStorage.setItem('TUGLIFE_GLOBAL', JSON.stringify(data));
            localStorage.setItem('TUGLIFE_CHEMAQ', chemaq);
        }

        function loadIdentity() {
            const savedGlobal = JSON.parse(localStorage.getItem('TUGLIFE_GLOBAL'));
            const savedChemaq = localStorage.getItem('TUGLIFE_CHEMAQ');

            if (savedGlobal) {
                document.getElementById('global-vessel').value = savedGlobal.vessel || '';
                document.getElementById('global-port').value = savedGlobal.port || '';
            }
            if (savedChemaq) {
                document.getElementById('global-chemaq').value = savedChemaq;
            }
        }

        window.onload = () => {
            lucide.createIcons();
            loadIdentity();
            initAuth();
        };
    </script>
</body>

</html>